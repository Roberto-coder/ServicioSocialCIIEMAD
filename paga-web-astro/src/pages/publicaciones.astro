---
import Layout from '../layouts/BaseLayout.astro';

const publicaciones = [
  //ana laura
  {
    tipo: "ARTÍCULO",
    anio: "2024",
    titulo: "Green Roof Systems within the Framework of a Circular Economy:  A Scoping Review. Recycling (2024), 9, 69.",
    autores: "Cervantes-Nájera, A.L.; Martínez-Rodríguez, M.-C.; Campos-Villegas, L.E.; Bello-Yañez, X.V.; Brenneisen, S.",
    enlace: "https://doi.org/10.3390/recycling9040069"
  },
  {
    tipo: "PAPER",
    anio: "2024",
    titulo: "Bibliometric analysis of Life Cycle Assessment articles visible in Scopus and Web of Science",
    autores: "Martínez-Rodríguez, M., Aponte-Gaona, S., & Cervantes-Nájera, A. (2024).",
    enlace: "https://doi.org/10.35381/cm.v10i18.1236"
  },
  {
    tipo: "PAPER",
    anio: "2024",
    titulo: "Integral Study of a Light Green Roof with Draining Organic Material in Gustavo A. Madero, Mexico City.",
    autores: "Cervantes-Nájera, A.L., Martínez-Rodríguez, M.C., Campos-Villegas, L.E. ",
    enlace: "https://doi.org/10.1007/978-3-030-98067-2_68-1"
  },
  {
    tipo: "PAPER",
    anio: "2023",
    titulo: "La conexión de las personas con las áreas verdes urbanas. Una revisión de la literatura.",
    autores: "Martínez-Rodríguez, M. C., & Cervantes-Nájera, A. L.",
    enlace: "https://doi.org/10.15658/10.15658/INVESTIGIUMIRE.231401.05"
  },
  {
    tipo: "PAPER",
    anio: "2022",
    titulo: "Evaluación de la calidad nutricional de los productos agrícolas caso: mercados de la Ciudad de México",
    autores: "Martínez Rodríguez, M. C., Campos Villegas, L. E., Alvarado Cardona, M., & Cervantes Nájera, A. L.",
    enlace: "https://doi.org/10.5154/r.rchsagt.2022.02.04"
  },
  {
    tipo: "PAPER",
    anio: "2021",
    titulo: "Green spaces resume their importance in cities after the COVID-19 pandemicA case of study from Mexico City, in Environmental Resilience and Transformation in Times of COVID-19",
    autores: "Martínez Rodríguez, M. C., Cervantes-Nájera, A. L., and Martínez M.V.",
    enlace: "https://doi.org/10.1016/B978-0-323-85512-9.00024-3"
  },
  {
    tipo: "PAPER",
    anio: "2022",
    titulo: "Indicadores de Carbono en la Industria Farmacéutica: Huella de Carbono vs Huella Ecológica.",
    autores: "Martínez-Rodríguez, M.-C., Marcelino-Aranda, M., Cervantes-Nájera, A. L., & Castillo Noguera, G.",
    enlace: "https://doi.org/10.21664/2238-8869.2022v11i1.p60-75"
  },
  {
    tipo: "PAPER",
    anio: "2025",
    titulo: " Innovación gubernamental: Políticas de conservación para las ecorregiones. Abordajes Teóricos, Impactos externos, políticas públicas y dinámica económica en el Desarrollo Regional ",
    autores: "Martínez-Rodríguez, M.-C., Saseendran, P. & Cervantes-Nájera, A. L.",
    enlace: "https://ru.iiec.unam.mx/4669/1/4-166-Martinez-Saseendran-Cervantes.pdf ISBN: 978-607-30-2640-6."
  },
  //Hector
  {
    tipo: "PAPER",
    anio: "2024",
    titulo: "Advancing Toward Sustainability: A Systematic Review Of Circular Economy Strategies In The Textile Industry.",
    autores: "Héctor Guadalupe Ramírez-Escamilla, María Concepción Martínez-Rodríguez",
    enlace: "https://doi.org/10.3390/recycling9050095"
  },
  {
    tipo: "TESIS",
    anio: "2025",
    titulo: "Propuesta de un plan de manejo basado en una economía circular para residuos sólidos textiles preconsumo: Chiconcuac, Estado de México, México ",
    autores: "Héctor Guadalupe Ramírez-Escamilla, María Concepción Martínez-Rodríguez.",
    enlace: "enlace proximamente"
  },
  {
    tipo: "CAPITULO 4 DEL LIBRO",
    anio: "2024",
    titulo: "Las Barreras De La Industria Textil Para Implementar La Economía Circular En México",
    autores: "Héctor Guadalupe Ramírez-Escamilla, María Concepción Martínez-Rodríguez.",
    enlace: "https://doi.org/10.52501/cc.170"
  },
  {
    tipo: "CAPITULO 2 DEL LIBRO",
    anio: "2024",
    titulo: "El Papel De Las Escuelas Verdes En La Concientización Y Acción Contra El Cambio Climático En México",
    autores: "Héctor Guadalupe Ramírez-Escamilla, María Concepción Martínez-Rodríguez.",
    enlace: "https://doi.org/10.52501/cc.187"
  },
  {
    tipo: "CAPITULO 9 DEL LIBRO",
    anio: "2024",
    titulo: "Economía Circular y Su Importancia En La Creación De Nuevos Empleos: Caso De Estudio México",
    autores: "Héctor Guadalupe Ramírez-Escamilla, María Concepción Martínez-Rodríguez.",
    enlace: "https://doi.org/10.52501/cc.187"
  }
];

// Obtener años y tipos únicos
//Debes convertirlos a número al ordenar:
const anios = [...new Set(publicaciones.map(p => p.anio))].sort((a, b) => Number(b) - Number(a));
const tipos = [...new Set(publicaciones.map(p => p.tipo))];

// Ordenar publicaciones por año descendente por defecto
const publicacionesOrdenadas = [...publicaciones].sort((a, b) => b.anio.localeCompare(a.anio));
---

<Layout>
  <section class="max-w-3xl mx-auto my-16 px-4">
    <h1 class="text-4xl font-serif text-guinda mb-10 text-center drop-shadow">Publicaciones</h1>
    <div class="flex flex-col sm:flex-row gap-4 mb-8 justify-center items-center">
      <label class="font-bold text-sm">
        Año:
        <select id="filtro-anio" class="ml-2 border rounded px-2 py-1">
          <option value="">Todos</option>
          {anios.map(anio => (
            <option value={anio}>{anio}</option>
          ))}
        </select>
      </label>
      <label class="font-bold text-sm">
        Tipo:
        <select id="filtro-tipo" class="ml-2 border rounded px-2 py-1">
          <option value="">Todos</option>
          {tipos.map(tipo => (
            <option value={tipo}>{tipo}</option>
          ))}
        </select>
      </label>
    </div>
    <ul id="lista-publicaciones" class="space-y-8">
      {publicacionesOrdenadas.map((pub, idx) => (
        <li
          tabindex="0"
          class="flex items-start bg-white border-l-8 rounded-xl shadow-md p-6 hover:shadow-lg transition-all duration-300 border-verde relative outline-none focus:ring-4 focus:ring-verde/30 focus:border-verde focus:shadow-2xl active:bg-blue-50"
          data-anio={pub.anio}
          data-tipo={pub.tipo}
        >
          <span class="mr-4 mt-1 text-verde">
            <svg class="w-7 h-7" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M19 21H5a2 2 0 01-2-2V7a2 2 0 012-2h4l2-2h6a2 2 0 012 2v12a2 2 0 01-2 2z"/></svg>
          </span>
          <div class="flex-1">
            <div class="flex items-center gap-3 mb-1">
              <span class="bg-verde/90 text-white text-xs font-bold px-3 py-1 rounded-full shadow">{pub.tipo}</span>
              <span class="bg-guinda/90 text-white text-xs font-bold px-2 py-0.5 rounded shadow">{pub.anio}</span>
            </div>
            <h2 class="text-xl font-bold text-gray-900 mb-1 leading-snug">{pub.titulo}</h2>
            <p class="text-sm text-gray-700 mb-2">{pub.autores}</p>
          </div>
          <a href={pub.enlace} class="ml-4 mt-2 bg-verde/90 text-white px-4 py-2 rounded-lg font-semibold shadow hover:bg-guinda transition-colors duration-200 self-center">Ver</a>
        </li>
      ))}
    </ul>
  </section>
</Layout>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const filtroAnio = document.getElementById('filtro-anio') as HTMLSelectElement | null;
    const filtroTipo = document.getElementById('filtro-tipo') as HTMLSelectElement | null;
    const lista = document.getElementById('lista-publicaciones') as HTMLUListElement | null;
    if (!filtroAnio || !filtroTipo || !lista) return;
    const items = Array.from(lista.children) as HTMLLIElement[];

    function filtrar() {
      const anio = filtroAnio ? filtroAnio.value : '';
      const tipo = filtroTipo ? filtroTipo.value : '';
      items.forEach(item => {
        const coincideAnio = !anio || item.getAttribute('data-anio') === anio;
        const coincideTipo = !tipo || item.getAttribute('data-tipo') === tipo;
        item.style.display = (coincideAnio && coincideTipo) ? '' : 'none';
      });
    }
    filtroAnio.addEventListener('change', filtrar);
    filtroTipo.addEventListener('change', filtrar);
  });
</script>
