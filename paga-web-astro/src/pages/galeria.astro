---
import Layout from "../layouts/BaseLayout.astro";

// Datos de ejemplo para la galería. Puedes agregar más aquí.
const galeriaItems = [
  {
    src: "/galeria/VISITA CECYT7 TAMBS.jpg",
    alt: "Cobertura Canal Once",
    title: "Entrevista en Canal Once",
    description: "Participación en el programa de Canal Once para discutir el impacto de las políticas ambientales en el desarrollo urbano sostenible.",
    fecha: "2024-05-20",
  },
  {
    src: "/galeria/40ANIV CIIEMAD DIRECTOR.jpg",
    alt: "40ANIV CIIEMAD DIRECTOR IPN",
    title: "40ANIV CIIEMAD DIRECTOR IPN",
    description: "Integrantes del equipo Sustentaterra en el día del 40 aniversario del CIIEMAD-IPN, en compañía del Director del IPN Dr. Arturo Reyes Sandoval.",
    fecha: "2024-04-15",
  },
  {
    src: "/galeria/COLOQUIO DE ESTUDIANTES CIIEMAD COORDINACIÓN.jpeg",
    alt: "OLOQUIO DE ESTUDIANTES CIIEMAD COORDINACIÓN",
    title: "COLOQUIO DE ESTUDIANTES CIIEMAD COORDINACIÓN",
    description: "Participación de Ana Laura Cervantes y Dra María Concepción como coordinadora y profesora acompañante en la inauguración del 12° Coloquio de Estudiantes del CIIEMAD.",
    fecha: "2024-06-01",
  },
  {
    src: "/galeria/COORDINADORA CEIMAS2024.jpeg",
    alt: "COORDINADORA CEIMAS2024",
    title: "COORDINADORA CEIMAS2024",
    description: "Participación de Xochitl Bello, Karla Ginez y Esperanza Hernández en el equipo de coordinación del 1er Congreso Estudiantil Interdisciplinario sobre Medio Ambiente y Sustentabilidad (CEIMAS 2024)",
    fecha: "2023-11-10",
  },
  {
    src: "/galeria/ALCN PONENCIA CONGRESO INT EN ADMON DE EMPRESAS PARA LA SOSTENIBILIDAD ESCA.jpg",
    alt: "ALCN PONENCIA CONGRESO INT EN ADMON DE EMPRESAS PARA LA SOSTENIBILIDAD ESCA",
    title: "ALCN PONENCIA CONGRESO INT EN ADMON DE EMPRESAS PARA LA SOSTENIBILIDAD ESCA",
    description: "Ponencia presentada por Ana Laura Cervantes en el Congreso Internacional en Administración de Empresas para la Sostenibilidad organizado por la ESCA-IPN 2024.",
    fecha: "2023-09-05",
  },
  {
    src: "/galeria/CARTEL CATEDRA MAYAGOITA 2023.jpg",
    alt: "CARTEL CATEDRA MAYAGOITA 2023",
    title: "CARTEL CATEDRA MAYAGOITA 2023",
    description: "Participación de Ana Laura Cervantes presentando cartel en la Cátedra Mayagoitia 2023.",
    fecha: "2024-02-28",
  },
  {
    src: "/galeria/equipo cartel catedra.jpg",
    alt: "Equipo cartel catedra.jpg",
    title: "EQUIPO CARTEL CATEDRA",
    description: "Fotografía de integrantes del equipo de Sustentaterra en la Cátedra Mayagoitia 2023.",
    fecha: "2024-02-28",
  },
  {
    src: "/galeria/team tnt SIEA 2023.jpg",
    alt: "team tnt SIEA 2023",
    title: "Team SIEA 2023",
    description: "Foto del equipo del Sustentaterra en el SIEA 2023.",
    fecha: "2024-02-28",
  },
  {
    src: "/galeria/SIEA 2023.jpg",
    alt: "SIEA 2023",
    title: "SIEA 2023",
    description: "Participación de Ana Laura Cervantes en el Simposio y Seminario Internacional de Educación Ambiental y Desarrollo Sustentable (SIEA 2023)",
    fecha: "2024-02-28",
  },
];

// Ordenar los elementos de la galería por fecha, de más reciente a más antiguo
galeriaItems.sort((a, b) => new Date(b.fecha).getTime() - new Date(a.fecha).getTime());
---

<Layout>
  <!-- Sección de la Galería -->
  <section class="max-w-7xl mx-auto my-12 px-4 sm:px-6 lg:px-8">
    <h1 class="text-4xl font-bold text-center text-guinda mb-12">Galería</h1>
    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
      {
        galeriaItems.map((item, index) => (
          <div
            class="group cursor-pointer overflow-hidden rounded-lg shadow-md hover:shadow-xl transition-shadow duration-300"
            data-index={index}
          >
            <img
              src={item.src}
              alt={item.alt}
              class="w-full h-48 object-cover group-hover:scale-110 transition-transform duration-300"
            />
          </div>
        ))
      }
    </div>
  </section>

  <!-- Modal (Lightbox) -->
  <div
    id="lightbox"
    class="fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center p-4 z-50 hidden"
  >
    <div
      id="lightbox-content"
      class="bg-white rounded-lg shadow-2xl max-w-2xl w-full"
    >
      <img
        id="lightbox-img"
        src=""
        alt=""
        class="w-full h-auto max-h-[70vh] object-contain rounded-t-lg"
      />
      <div class="p-6">
        <p id="lightbox-date" class="text-sm text-gray-500 mb-1"></p>
        <h3 id="lightbox-title" class="text-xl font-bold text-guinda mb-2"></h3>
        <p id="lightbox-desc" class="text-gray-700"></p>
      </div>
    </div>
    <button
      id="lightbox-close"
      class="absolute top-4 right-4 text-white text-4xl font-bold hover:text-gray-300"
      >&times;</button
    >
  </div>

  <script define:vars={{ galeriaItems }}>
    const lightbox = document.getElementById("lightbox");
    const lightboxImg = document.getElementById("lightbox-img");
    const lightboxTitle = document.getElementById("lightbox-title");
    const lightboxDate = document.getElementById("lightbox-date");
    const lightboxDesc = document.getElementById("lightbox-desc");
    const lightboxClose = document.getElementById("lightbox-close");
    const galleryImages = document.querySelectorAll("[data-index]");

    function openLightbox(index) {
      const item = galeriaItems[index];
      if (!item || !lightbox) return;

      lightboxImg.src = item.src;
      lightboxImg.alt = item.alt;
      lightboxTitle.textContent = item.title;
      
      // Formatear y mostrar la fecha
      const date = new Date(item.fecha);
      const options = { year: 'numeric', month: 'long', day: 'numeric', timeZone: 'UTC' };
      lightboxDate.textContent = date.toLocaleDateString('es-ES', options);

      lightboxDesc.textContent = item.description;

      lightbox.classList.remove("hidden");
    }

    function closeLightbox() {
      if (lightbox) lightbox.classList.add("hidden");
    }

    galleryImages.forEach((img) => {
      img.addEventListener("click", () => {
        const index = parseInt(img.dataset.index, 10);
        openLightbox(index);
      });
    });

    lightboxClose?.addEventListener("click", closeLightbox);
    lightbox?.addEventListener("click", (e) => {
      if (e.target === lightbox) closeLightbox();
    });
  </script>
</Layout>
