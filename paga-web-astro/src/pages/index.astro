---
import Layout from "../layouts/BaseLayout.astro";
---

<Layout>
  <!-- Estilos de Swiper desde CDN -->
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"
  />

  <!-- Slider Section -->
  <section class="w-full relative">
    <div class="swiper mySwiper h-[500px]">
      <div class="swiper-wrapper">
        <!-- Slide Servicio Social -->
        <div class="swiper-slide relative">
          <img
            src="/banner/ss1.png"
            src="/galeria/VISITA CECYT 7 A CIIEMAD TALLERES AMBIENTALES.jpg"
            class="w-full h-full object-cover"
            class="w-full h-full object-contain bg-gray-900"
            alt="Servicio Social"
          />
          <div
            class="absolute inset-0 bg-black bg-opacity-50 flex items-center justify-end pr-16"
          >
            <div class="text-right text-white max-w-lg">
              <h3 class="text-4xl font-bold mb-4 drop-shadow-lg">
              <h3 class="text-4xl font-bold mb-4 drop-shadow-lg ">
                LIBERA TU SERVICIO SOCIAL CON NOSOTROS
              </h3>
              <p class="text-xl drop-shadow-md">
                Pon en práctica tus conocimientos y habilidades, contáctanos.
              </p>
            </div>
          </div>
        </div>
        <div class="swiper-slide relative">
          <img
            src="/slider/image1i.jpg"
            class="w-full h-full object-scale-down"
            style="background-image: linear-gradient(to bottom, #0B4536, #60A917); object-position: center;"
            alt="Investigación Sostenible"
          />
          <div
            class="absolute inset-0 bg-black bg-opacity-30 flex items-center justify-end pr-16"
          >
            <div class="text-right text-white max-w-lg">
              <h3 class="text-4xl font-bold mb-4 drop-shadow-lg">
                Investigación Sostenible
              </h3>
              <p class="text-xl drop-shadow-md">
                Desarrollamos soluciones innovadoras para un futuro sustentable
              </p>
            </div>
          </div>
        </div>
        <div class="swiper-slide relative">
          <img
            src="/slider/image2i.jpg"
            class="w-full h-full object-cover"
            alt="Tecnología Verde"
          />
          <div
            class="absolute inset-0 bg-black bg-opacity-30 flex items-center justify-end pr-16"
          >
            <div class="text-right text-white max-w-lg">
              <h3 class="text-4xl font-bold mb-4 drop-shadow-lg">
                Tecnología Verde
              </h3>
              <p class="text-xl drop-shadow-md">
                Innovación tecnológica al servicio del medio ambiente
              </p>
            </div>
          </div>
        </div>
        <div class="swiper-slide relative">
          <img
            src="/slider/image3i.jpeg"
            class="w-full h-full object-cover"
            alt="Impacto Social"
          />
          <div
            class="absolute inset-0 bg-black bg-opacity-30 flex items-center justify-end pr-16"
          >
            <div class="text-right text-white max-w-lg">
              <h3 class="text-4xl font-bold mb-4 drop-shadow-lg">
                Impacto Social
              </h3>
              <p class="text-xl drop-shadow-md">
                Generando cambios positivos en la sociedad
              </p>
            </div>
          </div>
        </div>
      </div>
      <div class="swiper-pagination"></div>
    </div>
  </section>

  <!-- Texto de Muestra -->
  <section class="py-16 px-4 bg-gray-50 font-sans">
    <div class="max-w-4xl mx-auto text-center">
      <h2 class="text-4xl font-bold text-guinda mb-6 font-sans">
        Bienvenidos a <span class="text-verde">SUSTENTA-</span><span
          class="text-guinda">LAPP</span
        >
      </h2>
      <p class="text-lg text-black leading-relaxed font-sans">
        Somos un centro de investigación comprometido con el desarrollo
        sostenible y la innovación tecnológica. Trabajamos en proyectos que
        impactan positivamente en el medio ambiente y la sociedad, promoviendo
        soluciones sustentables para un futuro mejor.
      </p>
    </div>
  </section>

  <!-- Cards Section -->
  <section class="py-16 px-4 bg-white">
    <div class="max-w-6xl mx-auto">
      <div class="grid md:grid-cols-3 gap-8">
        <!-- Card 1: Nuestro Trabajo -->
        <div
          class="bg-white rounded-lg shadow-lg overflow-hidden border border-gray-200 hover:shadow-xl transition-shadow duration-300 transform hover:-translate-y-1 motion-reduce:transform-none"
        >
          <div class="p-6">
            <h3 class="text-2xl font-bold text-verde mb-4">Nuestro Trabajo</h3>
            <p class="text-black font-sans mb-6 leading-relaxed">
              Desarrollamos proyectos de investigación enfocados en
              sostenibilidad, innovación tecnológica y soluciones ambientales
              que generen un impacto positivo en la sociedad.
            </p>
            <a
              href="/nuestro-trabajo"
              class="inline-block bg-verde text-white px-6 py-3 rounded-md hover:bg-green-700 transition-colors duration-200 font-medium"
            >
              Conocer más
            </a>
          </div>
        </div>

        <!-- Card 2: ¿Quiénes Somos? -->
        <div
          class="bg-white rounded-lg shadow-lg overflow-hidden border border-gray-200 hover:shadow-xl transition-shadow duration-300 transform hover:-translate-y-1 motion-reduce:transform-none"
        >
          <div class="p-6">
            <h3 class="text-2xl font-bold text-guinda mb-4">¿Quiénes Somos?</h3>
            <p class="text-black font-sans mb-6 leading-relaxed">
              Somos un equipo multidisciplinario de investigadores y
              profesionales comprometidos con la generación de conocimiento y el
              desarrollo de tecnologías sustentables.
            </p>
            <a
              href="/sobre-nosotros"
              class="inline-block bg-guinda text-white px-6 py-3 rounded-md hover:bg-red-800 transition-colors duration-200 font-medium"
            >
              Conocer más
            </a>
          </div>
        </div>

        <!-- Card 3: Publicaciones -->
        <div
          class="bg-white rounded-lg shadow-lg overflow-hidden border border-gray-200 hover:shadow-xl transition-shadow duration-300 transform hover:-translate-y-1 motion-reduce:transform-none"
        >
          <div class="p-6">
            <h3 class="text-2xl font-bold text-gray-700 mb-4">Publicaciones</h3>
            <p class="text-black font-sans mb-6 leading-relaxed">
              Explora nuestras investigaciones, artículos científicos y
              publicaciones que contribuyen al avance del conocimiento en el
              área de desarrollo sustentable.
            </p>
            <a
              href="/publicaciones"
              class="inline-block bg-gray-700 text-white px-6 py-3 rounded-md hover:bg-gray-800 transition-colors duration-200 font-medium"
            >
              Ver publicaciones
            </a>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Mascota Section -->
  <section class="py-12 px-4 bg-gray-50">
    <div class="max-w-4xl mx-auto text-center">
      <h2 class="text-3xl font-serif text-guinda mb-4">
        Conozca a nuestra mascota
      </h2>
      <p class="text-gray-600 mb-6">
        Nuestra mascota saluda a la comunidad — Mr. Humedalcito
      </p>

      <div class="mx-auto w-56 h-56 relative">
        <!-- Layered images for crossfade effect -->
        <img
          id="mascota-img-0"
          src="/mascota/frame1.png"
          alt="Mascota fotograma 1"
          class="absolute inset-0 w-full h-full object-contain transition-opacity duration-150 opacity-100 rounded-xl shadow-md bg-white"
        />
        <img
          id="mascota-img-1"
          src="/mascota/frame2.png"
          alt="Mascota fotograma 2"
          class="absolute inset-0 w-full h-full object-contain transition-opacity duration-150 opacity-0 rounded-xl shadow-md bg-white"
        />
        <img
          id="mascota-img-2"
          src="/mascota/frame3.png"
          alt="Mascota fotograma 3"
          class="absolute inset-0 w-full h-full object-contain transition-opacity duration-150 opacity-0 rounded-xl shadow-md bg-white"
        />
      </div>

      <div class="mt-4 flex items-center justify-center gap-3">
        <button
          id="mascota-pause"
          class="px-3 py-1 bg-guinda text-white rounded">Pausar</button
        >
        <button
          id="mascota-resume"
          class="px-3 py-1 bg-verde text-white rounded hidden">Reanudar</button
        >
      </div>
    </div>
  </section>

  <!-- Script de Swiper -->
  <script is:inline>
    document.addEventListener("DOMContentLoaded", function () {
      import(
        "https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.mjs"
      ).then((module) => {
        const Swiper = module.default;

        new Swiper(".mySwiper", {
          loop: true,
          autoplay: {
            delay: 4000,
            disableOnInteraction: false,
            pauseOnMouseEnter: true,
          },
          pagination: {
            el: ".swiper-pagination",
            clickable: true,
          },
          effect: "slide",
          speed: 1000,
          grabCursor: true,
        });
      });
    });
  </script>

  <!-- Mascota script -->
  <script is:inline>
    document.addEventListener("DOMContentLoaded", function () {
      // Replace these paths with your mascot frames if you add custom images to /public/mascota/
      const FRAMES = [
        "/slider/image1i.jpg",
        "/slider/image2i.jpg",
        "/slider/image3i.jpeg",
      ];
      const imgs = [
        document.getElementById("mascota-img-0"),
        document.getElementById("mascota-img-1"),
        document.getElementById("mascota-img-2"),
      ];
      const pauseBtn = document.getElementById("mascota-pause");
      const resumeBtn = document.getElementById("mascota-resume");
      if (!imgs.every(Boolean) || !pauseBtn || !resumeBtn) return;

      let current = 0;
      let playing = true;
      const reduceMotion =
        window.matchMedia &&
        window.matchMedia("(prefers-reduced-motion: reduce)").matches;
      const INTERVAL = reduceMotion ? 1500 : 700;
      let timer = null;

      function showIndex(next) {
        imgs.forEach((el, i) => {
          if (!el) return;
          if (i === next) {
            el.classList.remove("opacity-0");
            el.classList.add("opacity-100");
          } else {
            el.classList.remove("opacity-100");
            el.classList.add("opacity-0");
          }
        });
        current = next;
      }

      function step() {
        const next = (current + 1) % FRAMES.length;
        showIndex(next);
      }

      function start() {
        if (timer) clearInterval(timer);
        if (playing) timer = setInterval(step, INTERVAL);
      }

      function stop() {
        if (timer) {
          clearInterval(timer);
          timer = null;
        }
      }

      // hover to pause
      imgs.forEach((el) => {
        el.addEventListener("mouseenter", () => {
          playing = false;
          stop();
          pauseBtn.classList.add("hidden");
          resumeBtn.classList.remove("hidden");
        });
        el.addEventListener("mouseleave", () => {
          playing = true;
          start();
          pauseBtn.classList.remove("hidden");
          resumeBtn.classList.add("hidden");
        });
      });

      pauseBtn.addEventListener("click", () => {
        playing = false;
        stop();
        pauseBtn.classList.add("hidden");
        resumeBtn.classList.remove("hidden");
      });
      resumeBtn.addEventListener("click", () => {
        playing = true;
        start();
        resumeBtn.classList.add("hidden");
        pauseBtn.classList.remove("hidden");
      });

      // initialize
      showIndex(0);
      if (!reduceMotion) start();
    });
  </script>
</Layout>
